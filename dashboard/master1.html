<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MASTER – Pannello di Controllo</title>

<!-- CSS -->
<link rel="stylesheet" href="master.css?v=10000">

<!-- FIREBASE (v8 compat) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<!-- CONFIG FIREBASE - PERCORSO CORRETTO -->
<script src="firebase-config.js"></script>

<!-- MASTER LOGIC -->
<script src="master-auth.js?v=10000" defer></script>
<script src="master.js?v=10000" defer></script>

</head>

<body onload="checkMasterLogin()">

<!-- HEADER -->
<header class="header">
    <h1 class="header-title">MASTER – Gestione Utenti & Struttura</h1>
</header>

<!-- PANEL -->
<div class="panel glass">

    <section>
        <h2>Link App & Dashboard</h2>
        <ul id="linkList" class="link-list"></ul>
    </section>

    <section>
        <h2>Crea nuovo utente App</h2>

        <label>Username</label>
        <input type="text" id="newUser">

        <label>PIN (6 cifre)</label>
        <input type="text" id="newPin" maxlength="6">

        <button class="btn-primary" onclick="createUser()">Crea Utente</button>
        <button class="btn-secondary" onclick="generatePin()">Genera PIN Automatico</button>
    </section>

    <section>
        <h2>Utenti App Registrati</h2>
        <table class="table" id="usersTable">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>PIN</th>
                    <th>Stato</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </section>

    <section>
        <h2>Registro attività MASTER</h2>

        <button class="btn-secondary" onclick="exportLog()">Scarica LOG</button>

        <table class="table" id="logTable">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Azione</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </section>

    <section>
        <h2>LEGGIMI</h2>
        <p>
            Questo pannello controlla gli utenti dell'app.  
            Tutte le operazioni vengono registrate nel LOG.
        </p>
    </section>

</div>

<!-- LOGOUT IN FONDO ALLA PAGINA -->
<button class="logout-bottom" onclick="logoutMaster()">Logout</button>

</body>
</html>
